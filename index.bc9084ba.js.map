{"mappings":"AAAA,MAAM,eAAe,IAAI,gBAAgB,SAAS,MAAM;AACxD,MAAM,SAAS,aAAa,GAAG,CAAC;AAChC,MAAM,QAAQ,aAAa,GAAG,CAAC;AAE/B,UAAU,aAAa,EAAE,SAAS,UAC/B,KAAK,CAAA;IACJ,QAAQ,GAAG,CAAC,cAAc;IAC1B,cAAc;AAChB,GACC,MAAM,CAAC,IAAM,QAAQ,KAAK,CAAC,GAAG;AAEjC,MAAM,gBAAgB,CAAC;IACrB,IAAI,CAAC,OAAO;IACZ,MAAM,uBAAuB,sBAAsB;IAEnD,GAAG,WAAW,CAAC,SAAS,CAAC;QACrB,iBAAiB;QACjB,sBAAsB;IAC1B,GAAG,IAAI,CAAC,CAAC;QACL,QAAQ,GAAG,CAAC,uBAAuB;IACvC,GAAG,KAAK,CAAC,CAAC;QACN,QAAQ,GAAG,CAAC,kCAAkC;IAClD;AACF;AAEA,MAAM,wBAAwB,CAAC;IAC7B,MAAM,UAAU,IAAI,MAAM,CAAC,AAAC,CAAA,IAAI,aAAa,MAAM,GAAG,CAAA,IAAK;IAC3D,MAAM,SAAS,AAAC,CAAA,eAAe,OAAM,EAAG,OAAO,CAAC,OAAO,KAAK,OAAO,CAAC,MAAM;IAC1E,MAAM,UAAU,OAAO,IAAI,CAAC;IAC5B,MAAM,cAAc,IAAI,WAAW,QAAQ,MAAM;IACjD,IAAK,IAAI,IAAI,GAAG,IAAI,QAAQ,MAAM,EAAE,EAAE,EAClC,WAAW,CAAC,EAAE,GAAG,QAAQ,UAAU,CAAC;IAExC,OAAO;AACT;AAEA,MAAM,UAAU,IAAI,IAAI,CAAC,EAAE,OAAO,MAAM,EAAE,SAAS,MAAM,CAAC,QAAQ,GAAG,CAAC;AACtE,SAAS,cAAc,CAAC,aAAa,iBAAiB,SAAS,CAAC;IAC9D,EAAE,cAAc;IAEhB,MAAM,SAAS;QAAC,QAAQ;IAAM,GAC3B,IAAI,CAAC,QAAQ,GAAG,EAChB,KAAK,CAAC,QAAQ,KAAK;AACxB","sources":["src/main.ts"],"sourcesContent":["const searchParams = new URLSearchParams(location.search);\r\nconst apiUrl = searchParams.get('api-url');\r\nconst vapid = searchParams.get('vapid');\r\n\r\nnavigator.serviceWorker?.register('/sw.ts')\r\n  .then(reg  => {\r\n    console.log('registered', reg)\r\n    subscribeUser(reg);\r\n  })\r\n  .catch((e) => console.error(e, 'registration failed'))\r\n\r\nconst subscribeUser = (sw: ServiceWorkerRegistration) => {\r\n  if (!vapid) return;\r\n  const applicationServerKey = urlBase64ToUint8Array(vapid);\r\n\r\n  sw.pushManager.subscribe({\r\n      userVisibleOnly: true,\r\n      applicationServerKey: applicationServerKey\r\n  }).then((subscription) => {\r\n      console.log('User is subscribed:', subscription);\r\n  }).catch((err) => {\r\n      console.log('Failed to subscribe the user: ', err);\r\n  });\r\n}\r\n\r\nconst urlBase64ToUint8Array = (base64String: string) => {\r\n  const padding = '='.repeat((4 - base64String.length % 4) % 4);\r\n  const base64 = (base64String + padding).replace(/\\-/g, '+').replace(/_/g, '/');\r\n  const rawData = window.atob(base64);\r\n  const outputArray = new Uint8Array(rawData.length);\r\n  for (let i = 0; i < rawData.length; ++i) {\r\n      outputArray[i] = rawData.charCodeAt(i);\r\n  }\r\n  return outputArray;\r\n}\r\n\r\nconst pingUrl = new URL(`${apiUrl}/ping/${location.search.toString()}`);\r\ndocument.getElementById('ping-btn')?.addEventListener('click', (e) => {\r\n  e.preventDefault()\r\n\r\n  fetch(pingUrl, {method: 'POST'})\r\n    .then(console.log)\r\n    .catch(console.error);\r\n})\r\n\r\n"],"names":[],"version":3,"file":"index.bc9084ba.js.map","sourceRoot":"/__parcel_source_root/"}